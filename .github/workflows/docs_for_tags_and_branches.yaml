name: Rebuild docs for all branches and tags

# TODO change to --> on: workflow_dispatch
on:
  push:
    branches: [ docs-for-tags-and-branches ]

jobs:
  rebuild-docs:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3

#      - name: Install
#        run: python -m pip install --upgrade pip && pip install -e .
#
#      - name: Install docs requirements
#        run: pip install -r docs/requirements.txt && pip install requests

      - name: List Branches and Tags
        id: list-refs
        run: |
          echo "::set-output name=branches::$(git for-each-ref --format='%(refname:short)' refs/heads/)"
          echo "::set-output name=tags::$(git for-each-ref --format='%(refname:short)' refs/tags/)"
#
#
#      - name: Build docs
#        run: cd docs && make json
#
#      - name: Get current branch name
#        run: echo "CURRENT_BRANCH=${GITHUB_REF#refs/heads/}" >> $GITHUB_ENV
#
#      - name: Set target branch name
#        run: echo "BRANCH_NAME=${CURRENT_BRANCH}" >> $GITHUB_ENV
#
#      - name: Push directory to another repository
#        uses: cpina/github-action-push-to-another-repository@v1.7.2
#        env:
#          SSH_DEPLOY_KEY: ${{ secrets.SSH_DEPLOY_KEY }}
#        with:
#          source-directory: 'docs/_build/json/'
#          destination-github-username: 'run-house'
#          destination-repository-name: 'runhouse-docs'
#          target-branch: ${{ env.BRANCH_NAME }}
#          create-target-branch-if-needed: true
